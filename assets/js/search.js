
var documents = [{
    "id": 0,
    "url": "https://www.wroscoe.com/404.html",
    "title": "",
    "body": " 404 Page not found :(  The requested page could not be found. "
    }, {
    "id": 1,
    "url": "https://www.wroscoe.com/about/",
    "title": "About Me",
    "body": "This is where you put the contents of your About page. Like all your pages, it’s in Markdown format. This website is powered by fastpages 1.       a blogging platform that natively supports Jupyter notebooks in addition to other formats.  &#8617;    "
    }, {
    "id": 2,
    "url": "https://www.wroscoe.com/categories/",
    "title": "Tags",
    "body": "Contents: {% if site. categories. size &gt; 0 %} {% for category in site. categories %} {% capture category_name %}{{ category | first }}{% endcapture %} {{ category_name }}{% endfor %}{% endif %} {% for category in site. categories %}  {% capture category_name %}{{ category | first }}{% endcapture %} &lt;h3 id = {{ category_name }} &gt;&lt;i class= fas fa-tags category-tags-icon &gt;&lt;/i&gt;&lt;/i&gt; {{ category_name }}&lt;/h3&gt;&lt;a name= {{ category_name | slugize }} &gt;&lt;/a&gt;{% for post in site. categories[category_name] %}{%- assign date_format = site. minima. date_format | default:  %b %-d, %Y  -%}&lt;article class= archive-item &gt; &lt;p class= post-meta post-meta-title &gt;&lt;a class= page-meta  href= {{ site. baseurl }}{{ post. url }} &gt;{{post. title}}&lt;/a&gt; • {{ post. date | date: date_format }}&lt;/p&gt;&lt;/article&gt;{% endfor %} {% endfor %}"
    }, {
    "id": 3,
    "url": "https://www.wroscoe.com/images/copied_from_nb/",
    "title": "",
    "body": "WarningDo not manually save images into this folder. This is used by GitHub Actions to automatically copy images.  Any images you save into this folder could be deleted at build time. "
    }, {
    "id": 4,
    "url": "https://www.wroscoe.com/fastpages/jupyter/2020/02/20/test.html",
    "title": "Fastpages Notebook Blog Post",
    "body": "2020/02/20 -           About&#182;This notebook is a demonstration of some of capabilities of fastpages with notebooks. With fastpages you can save your jupyter notebooks into the _notebooks folder at the root of your repository, and they will be automatically be converted to Jekyll compliant blog posts! Front Matter&#182;: Front Matter is a markdown cell at the beginning of your notebook that allows you to inject metadata into your notebook. For example: Setting toc: true will automatically generate a table of contentsSetting badges: true will automatically include GitHub and Google Colab links to your notebook. Setting comments: true will enable commenting on your blog post, powered by utterances. More details and options for front matter can be viewed on the front matter section of the README. Markdown Shortcuts&#182;: put a #hide flag at the top of any cell you want to completely hide in the docs put a #collapse flag at the top of any cell if you want to hide that cell by default, but stil have it be visible to the reader:       #import asdfasdfsadfimport pandas as pdimport altair as altprint(&#39;hello3&#39;)  ---------------------------------------------------------------------------ModuleNotFoundError            Traceback (most recent call last)&lt;ipython-input-3-373159dfc6ce&gt; in &lt;module&gt;   1 #import asdfasdfsadf   2 import pandas as pd----&gt; 3 import altair as alt   4 print(&#39;hello3&#39;)ModuleNotFoundError: No module named &#39;altair&#39;  put a #collapse_show flag at the top of any cell if you want to show that cell by default, but give the reader the option to hide it:              #collapse_showcars = &#39;https://vega. github. io/vega-datasets/data/cars. json&#39;movies = &#39;https://vega. github. io/vega-datasets/data/movies. json&#39;sp500 = &#39;https://vega. github. io/vega-datasets/data/sp500. csv&#39;stocks = &#39;https://vega. github. io/vega-datasets/data/stocks. csv&#39;flights = &#39;https://vega. github. io/vega-datasets/data/flights-5k. json&#39;       Interactive Charts With Altair&#182;: Charts made with Altair remain interactive.  Example charts taken from this repo, specifically this notebook. Example 1: DropDown&#182;:       # single-value selection over [Major_Genre, MPAA_Rating] pairs# use specific hard-wired values as the initial selected valuesselection = alt. selection_single(  name=&#39;Select&#39;,  fields=[&#39;Major_Genre&#39;, &#39;MPAA_Rating&#39;],  init={&#39;Major_Genre&#39;: &#39;Drama&#39;, &#39;MPAA_Rating&#39;: &#39;R&#39;},  bind={&#39;Major_Genre&#39;: alt. binding_select(options=genres), &#39;MPAA_Rating&#39;: alt. binding_radio(options=mpaa)}) # scatter plot, modify opacity based on selectionalt. Chart(movies). mark_circle(). add_selection(  selection). encode(  x=&#39;Rotten_Tomatoes_Rating:Q&#39;,  y=&#39;IMDB_Rating:Q&#39;,  tooltip=&#39;Title:N&#39;,  opacity=alt. condition(selection, alt. value(0. 75), alt. value(0. 05)))    Example 2: Tooltips&#182;:       alt. Chart(movies). mark_circle(). add_selection(  alt. selection_interval(bind=&#39;scales&#39;, encodings=[&#39;x&#39;])). encode(  x=&#39;Rotten_Tomatoes_Rating:Q&#39;,  y=alt. Y(&#39;IMDB_Rating:Q&#39;, axis=alt. Axis(minExtent=30)), # use min extent to stabilize axis title placement  tooltip=[&#39;Title:N&#39;, &#39;Release_Date:N&#39;, &#39;IMDB_Rating:Q&#39;, &#39;Rotten_Tomatoes_Rating:Q&#39;]). properties(  width=600,  height=400)    Example 3: More Tooltips&#182;:       # select a point for which to provide details-on-demandlabel = alt. selection_single(  encodings=[&#39;x&#39;], # limit selection to x-axis value  on=&#39;mouseover&#39;, # select on mouseover events  nearest=True,  # select data point nearest the cursor  empty=&#39;none&#39;   # empty selection includes no data points)# define our base line chart of stock pricesbase = alt. Chart(). mark_line(). encode(  alt. X(&#39;date:T&#39;),  alt. Y(&#39;price:Q&#39;, scale=alt. Scale(type=&#39;log&#39;)),  alt. Color(&#39;symbol:N&#39;))alt. layer(  base, # base line chart    # add a rule mark to serve as a guide line  alt. Chart(). mark_rule(color=&#39;#aaa&#39;). encode(    x=&#39;date:T&#39;  ). transform_filter(label),    # add circle marks for selected time points, hide unselected points  base. mark_circle(). encode(    opacity=alt. condition(label, alt. value(1), alt. value(0))  ). add_selection(label),  # add white stroked text to provide a legible background for labels  base. mark_text(align=&#39;left&#39;, dx=5, dy=-5, stroke=&#39;white&#39;, strokeWidth=2). encode(    text=&#39;price:Q&#39;  ). transform_filter(label),  # add text labels for stock prices  base. mark_text(align=&#39;left&#39;, dx=5, dy=-5). encode(    text=&#39;price:Q&#39;  ). transform_filter(label),    data=stocks). properties(  width=700,  height=400)    Data Tables&#182;: You can display tables per the usual way in your blog:       movies = &#39;https://vega. github. io/vega-datasets/data/movies. json&#39;df = pd. read_json(movies)# display table with pandasdf[[&#39;Title&#39;, &#39;Worldwide_Gross&#39;,   &#39;Production_Budget&#39;, &#39;IMDB_Rating&#39;]]. head()           Title   Worldwide_Gross   Production_Budget   IMDB_Rating         0   The Land Girls   146083. 0   8000000. 0   6. 1       1   First Love, Last Rites   10876. 0   300000. 0   6. 9       2   I Married a Strange Person   203134. 0   250000. 0   6. 8       3   Let's Talk About Sex   373615. 0   300000. 0   NaN       4   Slam   1087521. 0   1000000. 0   3. 4     Images&#182;: Local Images&#182;: You can reference local images and they will be copied and rendered on your blog automatically.  You can include these with the following markdown syntax: ![](my_icons/fastai_logo. png) Remote Images&#182;: Remote images can be included with the following markdown syntax: ![](https://image. flaticon. com/icons/svg/36/36686. svg) Animated Gifs&#182;: Animated Gifs work, too! ![](https://upload. wikimedia. org/wikipedia/commons/7/71/ChessPawnSpecialMoves. gif) Captions&#182;: You can include captions with markdown images like this: ![](https://www. fast. ai/images/fastai_paper/show_batch. png  Credit: https://www. fast. ai/2020/02/13/fastai-A-Layered-API-for-Deep-Learning/ ) Other Elements&#182;Tweetcards&#182;: Typing &gt; twitter: https://twitter. com/jakevdp/status/1204765621767901185?s=20 will render this:Altair 4. 0 is released! https://t. co/PCyrIOTcvvTry it with: pip install -U altairThe full list of changes is at https://t. co/roXmzcsT58 . . . read on for some highlights. pic. twitter. com/vWJ0ZveKbZ &mdash; Jake VanderPlas (@jakevdp) December 11, 2019 Youtube Videos&#182;: Typing &gt; youtube: https://youtu. be/XfoYk_Z5AkI will render this: Boxes / Callouts&#182;: Typing &gt; Warning: There will be no second warning! will render this:    Warning: There will be no second warning! Typing &gt; Important: Pay attention! It's important. will render this:    Important: Pay attention! It&#8217;s important. Typing &gt; Tip: This is my tip. will render this:    Tip: This is my tip. Typing &gt; Note: Take note of this. will render this:    Note: Take note of this. Typing &gt; Note: A doc link to [an example website: fast. ai](https://www. fast. ai/) should also work fine. will render in the docs:    Note: A doc link to an example website: fast. ai should also work fine. "
    }, {
    "id": 5,
    "url": "https://www.wroscoe.com/fastpages/jupyter/2020/02/20/first.html",
    "title": "Networkx example",
    "body": "2020/02/20 -           About&#182;This notebook is a demonstration of some of capabilities of fastpages with notebooks. With fastpages you can save your jupyter notebooks into the _notebooks folder at the root of your repository, and they will be automatically be converted to Jekyll compliant blog posts! Front Matter&#182;: Front Matter is a markdown cell at the beginning of your notebook that allows you to inject metadata into your notebook. For example: Setting toc: true will automatically generate a table of contentsSetting badges: true will automatically include GitHub and Google Colab links to your notebook. Setting comments: true will enable commenting on your blog post, powered by utterances. More details and options for front matter can be viewed on the front matter section of the README. Markdown Shortcuts&#182;: put a #hide flag at the top of any cell you want to completely hide in the docs put a #collapse flag at the top of any cell if you want to hide that cell by default, but stil have it be visible to the reader:       #import asdfasdfsadfimport pandas as pdimport altair as altimport networkx    put a #collapse_show flag at the top of any cell if you want to show that cell by default, but give the reader the option to hide it:              #collapseimport matplotlib as mplimport matplotlib. pyplot as pltimport networkx as nxG = nx. generators. directed. random_k_out_graph(10, 3, 0. 5)pos = nx. layout. spring_layout(G)node_sizes = [3 + 10 * i for i in range(len(G))]M = G. number_of_edges()edge_colors = range(2, M + 2)edge_alphas = [(5 + i) / (M + 4) for i in range(M)]nodes = nx. draw_networkx_nodes(G, pos, node_size=node_sizes, node_color=&#39;blue&#39;)edges = nx. draw_networkx_edges(G, pos, node_size=node_sizes, arrowstyle=&#39;-&gt;&#39;,                arrowsize=10, edge_color=edge_colors,                edge_cmap=plt. cm. Blues, width=2)# set alpha value for each edgefor i in range(M):  edges[i]. set_alpha(edge_alphas[i])pc = mpl. collections. PatchCollection(edges, cmap=plt. cm. Blues)pc. set_array(edge_colors)plt. colorbar(pc)ax = plt. gca()ax. set_axis_off()plt. show()       Interactive Charts With Altair&#182;: Charts made with Altair remain interactive.  Example charts taken from this repo, specifically this notebook. Example 1: DropDown&#182;:       # single-value selection over [Major_Genre, MPAA_Rating] pairs# use specific hard-wired values as the initial selected valuesselection = alt. selection_single(  name=&#39;Select&#39;,  fields=[&#39;Major_Genre&#39;, &#39;MPAA_Rating&#39;],  init={&#39;Major_Genre&#39;: &#39;Drama&#39;, &#39;MPAA_Rating&#39;: &#39;R&#39;},  bind={&#39;Major_Genre&#39;: alt. binding_select(options=genres), &#39;MPAA_Rating&#39;: alt. binding_radio(options=mpaa)}) # scatter plot, modify opacity based on selectionalt. Chart(movies). mark_circle(). add_selection(  selection). encode(  x=&#39;Rotten_Tomatoes_Rating:Q&#39;,  y=&#39;IMDB_Rating:Q&#39;,  tooltip=&#39;Title:N&#39;,  opacity=alt. condition(selection, alt. value(0. 75), alt. value(0. 05)))    Example 2: Tooltips&#182;:       alt. Chart(movies). mark_circle(). add_selection(  alt. selection_interval(bind=&#39;scales&#39;, encodings=[&#39;x&#39;])). encode(  x=&#39;Rotten_Tomatoes_Rating:Q&#39;,  y=alt. Y(&#39;IMDB_Rating:Q&#39;, axis=alt. Axis(minExtent=30)), # use min extent to stabilize axis title placement  tooltip=[&#39;Title:N&#39;, &#39;Release_Date:N&#39;, &#39;IMDB_Rating:Q&#39;, &#39;Rotten_Tomatoes_Rating:Q&#39;]). properties(  width=600,  height=400)    Example 3: More Tooltips&#182;:       # select a point for which to provide details-on-demandlabel = alt. selection_single(  encodings=[&#39;x&#39;], # limit selection to x-axis value  on=&#39;mouseover&#39;, # select on mouseover events  nearest=True,  # select data point nearest the cursor  empty=&#39;none&#39;   # empty selection includes no data points)# define our base line chart of stock pricesbase = alt. Chart(). mark_line(). encode(  alt. X(&#39;date:T&#39;),  alt. Y(&#39;price:Q&#39;, scale=alt. Scale(type=&#39;log&#39;)),  alt. Color(&#39;symbol:N&#39;))alt. layer(  base, # base line chart    # add a rule mark to serve as a guide line  alt. Chart(). mark_rule(color=&#39;#aaa&#39;). encode(    x=&#39;date:T&#39;  ). transform_filter(label),    # add circle marks for selected time points, hide unselected points  base. mark_circle(). encode(    opacity=alt. condition(label, alt. value(1), alt. value(0))  ). add_selection(label),  # add white stroked text to provide a legible background for labels  base. mark_text(align=&#39;left&#39;, dx=5, dy=-5, stroke=&#39;white&#39;, strokeWidth=2). encode(    text=&#39;price:Q&#39;  ). transform_filter(label),  # add text labels for stock prices  base. mark_text(align=&#39;left&#39;, dx=5, dy=-5). encode(    text=&#39;price:Q&#39;  ). transform_filter(label),    data=stocks). properties(  width=700,  height=400)    Data Tables&#182;: You can display tables per the usual way in your blog:       movies = &#39;https://vega. github. io/vega-datasets/data/movies. json&#39;df = pd. read_json(movies)# display table with pandasdf[[&#39;Title&#39;, &#39;Worldwide_Gross&#39;,   &#39;Production_Budget&#39;, &#39;IMDB_Rating&#39;]]. head()           Title   Worldwide_Gross   Production_Budget   IMDB_Rating         0   The Land Girls   146083. 0   8000000. 0   6. 1       1   First Love, Last Rites   10876. 0   300000. 0   6. 9       2   I Married a Strange Person   203134. 0   250000. 0   6. 8       3   Let's Talk About Sex   373615. 0   300000. 0   NaN       4   Slam   1087521. 0   1000000. 0   3. 4     Images&#182;: Local Images&#182;: You can reference local images and they will be copied and rendered on your blog automatically.  You can include these with the following markdown syntax: ![](my_icons/fastai_logo. png) Remote Images&#182;: Remote images can be included with the following markdown syntax: ![](https://image. flaticon. com/icons/svg/36/36686. svg) Animated Gifs&#182;: Animated Gifs work, too! ![](https://upload. wikimedia. org/wikipedia/commons/7/71/ChessPawnSpecialMoves. gif) Captions&#182;: You can include captions with markdown images like this: ![](https://www. fast. ai/images/fastai_paper/show_batch. png  Credit: https://www. fast. ai/2020/02/13/fastai-A-Layered-API-for-Deep-Learning/ ) Other Elements&#182;Tweetcards&#182;: Typing &gt; twitter: https://twitter. com/jakevdp/status/1204765621767901185?s=20 will render this:Altair 4. 0 is released! https://t. co/PCyrIOTcvvTry it with: pip install -U altairThe full list of changes is at https://t. co/roXmzcsT58 . . . read on for some highlights. pic. twitter. com/vWJ0ZveKbZ &mdash; Jake VanderPlas (@jakevdp) December 11, 2019 Youtube Videos&#182;: Typing &gt; youtube: https://youtu. be/XfoYk_Z5AkI will render this: Boxes / Callouts&#182;: Typing &gt; Warning: There will be no second warning! will render this:    Warning: There will be no second warning! Typing &gt; Important: Pay attention! It's important. will render this:    Important: Pay attention! It&#8217;s important. Typing &gt; Tip: This is my tip. will render this:    Tip: This is my tip. Typing &gt; Note: Take note of this. will render this:    Note: Take note of this. Typing &gt; Note: A doc link to [an example website: fast. ai](https://www. fast. ai/) should also work fine. will render in the docs:    Note: A doc link to an example website: fast. ai should also work fine. "
    }, {
    "id": 6,
    "url": "https://www.wroscoe.com/fastpages/markdown/2020/01/14/test-markdown-post.html",
    "title": "Example Markdown Post",
    "body": "2020/01/14 - Basic setup: Jekyll requires blog post files to be named according to the following format: YEAR-MONTH-DAY-filename. md Where YEAR is a four-digit number, MONTH and DAY are both two-digit numbers, and filename is whatever file name you choose, to remind yourself what this post is about. . md is the file extension for markdown files. The first line of the file should start with a single hash character, then a space, then your title. This is how you create a “level 1 heading” in markdown. Then you can create level 2, 3, etc headings as you wish but repeating the hash character, such as you see in the line ## File names above. Basic formatting: You can use italics, bold, code font text, and create links. Here’s a footnote 1. Here’s a horizontal rule: Lists: Here’s a list:  item 1 item 2And a numbered list:  item 1 item 2Boxes and stuff:  This is a quotation    You can include alert boxes…and…    You can include info boxesImages: Code: General preformatted text: # Do a thingdo_thing()Python code and output: # Prints '2'print(1+1)2Tables:       Column 1   Column 2         A thing   Another thing   Tweetcards: Altair 4. 0 is released! https://t. co/PCyrIOTcvvTry it with: pip install -U altairThe full list of changes is at https://t. co/roXmzcsT58 . . . read on for some highlights. pic. twitter. com/vWJ0ZveKbZ &mdash; Jake VanderPlas (@jakevdp) December 11, 2019Footnotes:       This is the footnote.  &#8617;    "
    }, {
    "id": 7,
    "url": "https://www.wroscoe.com/donkeycar/tensorflow/deeplearing/devops/2017/01/22/jan_diyrobocar_race_debrief.html",
    "title": "January 2017 DIYRobocar Race Debrief",
    "body": "2017/01/22 -            Lessons learned from the last DIYRobocar race. Overall today was a success given that two Donkey controlled vehicles did at least one completely autonomous lap prior to race time. This is a big improvement from the same event 3 months ago when we worked on Adams car all day to get it to lurch forward and turn right. This is short debrief of what I learned this weekend to help guide our next efforts to make Donkey a better library for training autopilots for these races.  Of course, after the race the driving problems became obvious.  The vehicle drive loop was only updating every 1/5th of a second but should have been updating every 1/15th of a second or more frequently. This meant we didn’t collect very much training data and the autopilot didn’t update often. Training data was not cleaned. We didn’t have a good way to view the training data on the ec2 instance so we could not see that there we were using training data that included bad steering, and even images when the vehicle had been picked up. Beyond bugs, how can do better at these races?&#182;: On a race day, we have 4-6 hours to take a proven car and autopilot and train it to perform on a new track. The more efficiently we can improve the autopilot performance the better we’ll do. Here’s an overview problems I saw today and proposals how to fix them.  Specific issues and solutions live in github issues. Many steps are required to update an driving model. &#182;: At one point today I had 20+ terminal windows open because changing the autopilot requires many useless “plumbing” steps. These steps can be automated or made easier with command line arguments or web interface. Switching models requires restarting the serverIt's difficult to remember which session was the good session. Combining sessions is a separate script. Driving is required to test models. &#182;: Since updating and driving an autopilot takes time, we need to make sure that our changes actually improve the autopilot before we test it on the track. A trusted performance measurement is needed at the time of training. This could be a combination of the error on a validation dataset and a visual showing how closely predicted values were to actual. There is no way to debug an autopilot. &#182;: Currently an autopilot either works or it doesn’t. Driving performance are the only clues to help us understand what’s going wrong. Helpful clues would include:Adding a visual showing what the network is queuing off of would help. Lag timesPredicted vs actual overlaid on image. Common problems that don&#8217;t have obvious solutions. &#182;: Even after a common problem has been identified, there’s no standard solution to fix the problem. “Agile training” could be used to correct the autopilot by creating more training data where the autopilot fails. Vehicle doesn’t turn sharp enough. Vehicle doesn’t turn at all on a corner. Vehicle goes to slow. There is no easy way to clean training data on a remote instance. &#182;: Training on bad data makes bad autopilots. To learn where bad training data exists you need to see the image the recorded steering values, This is impossible on a CLI but would be possible through a web interface. There are other improvements we can make but these are the big unsexy ones that will help most. Also, get a friend to build a car. Build a Donkey or any of the other reference builds on DIYRobocars. Let the fleet learning begin.  Using donkey to control my car from a website using a javascript joystick. "
    }, {
    "id": 8,
    "url": "https://www.wroscoe.com/donkeycar/tensorflow/deeplearing/self%20driving/2017/01/12/lane_following_autopilot.html",
    "title": "Lane Following Autopilot with Keras & Tensorflow.",
    "body": "2017/01/12 -           This document walks through how to create a convolution neural network using Keras+Tensorflow and train it to keep a car between two white lines.  Updated Feb 2, 2017 - Thanks to comments on Hacker News, I've updated this doc to use more machine learning best pratices. Here is a Raspberry Pi controlled RC car using the autopilot crated in this document to drive between the lines. See the donkey repository for instructions to build your own car.        import osimport urllib. requestimport pickle%matplotlib inlineimport matplotlibfrom matplotlib. pyplot import imshow    Get the driving data&#182;: The dataset is composed of ~7900 images and steering angles collected as I manually drove the car. About 2/3 of the images are with the car between the lines. The other third is of the car starting off course and correcting by driving back to between the lines.       #downlaod driving data (450Mb) data_url = &#39;https://s3. amazonaws. com/donkey_resources/indoor_lanes. pkl&#39;file_path, headers = urllib. request. urlretrieve(data_url)print(file_path)  /tmp/tmpjjuhirpf  The dataset consists of 2 pickled arrays. X are the image arrays and Y is an array of the coresponding steering angles.       #extract datawith open(file_path, &#39;rb&#39;) as f:  X, Y = pickle. load(f)  print(&#39;X. shape: &#39;, X. shape)print(&#39;Y. shape: &#39;, Y. shape)imshow(X[0])  X. shape: (7892, 120, 160, 3)Y. shape: (7892,)&lt;matplotlib. image. AxesImage at 0x7f3f6b577828&gt;  Split Data&#182;: Here we'll shuffle our data and separate the data into three parts. Training data will be used to train our driving model, Validation data is used avoid overfitting the model and Test data is used to test if our model learned anything.       import numpy as np          #shuffle both X and Y the same waydef unison_shuffled_copies(X, Y):  assert len(X) == len(Y)  p = np. random. permutation(len(X))  return X[p], Y[p]shuffled_X, shuffled_Y = unison_shuffled_copies(X,Y)len(shuffled_X)  7892        test_cutoff = int(len(X) * . 8) # 80% of data used for trainingval_cutoff = test_cutoff + int(len(X) * . 1) # 10% of data used for validation and test data train_X, train_Y = shuffled_X[:test_cutoff], shuffled_Y[:test_cutoff]val_X, val_Y = shuffled_X[test_cutoff:val_cutoff], shuffled_Y[test_cutoff:val_cutoff]test_X, test_Y = shuffled_X[val_cutoff:], shuffled_Y[val_cutoff:]len(train_X) + len(val_X) + len(test_X)  7892  Augment Training Data&#182;: To double our training data and prevent steering bias, we flip each image and steering angle and add it to the dataset. There are additional ways to augment driving data using translations and fake shadows but I didn't use those for this autopilot.       X_flipped = np. array([np. fliplr(i) for i in train_X])Y_flipped = np. array([-i for i in train_Y])train_X = np. concatenate([train_X, X_flipped])train_Y = np. concatenate([train_Y, Y_flipped])len(train_X)  12626  Build a driving model&#182;: This driving model will be an end-to-end neural network that accepts image arrays as input and outputs a steering angle between -90 (left) and 90 (right). To do this we'll use a 3 layer convolution network with one fully connected layer. This model is based off of Otavio's Carputer but does not produce a throttle value output, does not use past steering values as input into the model, and uses one less convolution layer.       from keras. models import Model, load_modelfrom keras. layers import Input, Convolution2D, MaxPooling2D, Activation, Dropout, Flatten, Dense  Using TensorFlow backend.         img_in = Input(shape=(120, 160, 3), name=&#39;img_in&#39;)angle_in = Input(shape=(1,), name=&#39;angle_in&#39;)x = Convolution2D(8, 3, 3)(img_in)x = Activation(&#39;relu&#39;)(x)x = MaxPooling2D(pool_size=(2, 2))(x)x = Convolution2D(16, 3, 3)(x)x = Activation(&#39;relu&#39;)(x)x = MaxPooling2D(pool_size=(2, 2))(x)x = Convolution2D(32, 3, 3)(x)x = Activation(&#39;relu&#39;)(x)x = MaxPooling2D(pool_size=(2, 2))(x)merged = Flatten()(x)x = Dense(256)(merged)x = Activation(&#39;linear&#39;)(x)x = Dropout(. 2)(x)angle_out = Dense(1, name=&#39;angle_out&#39;)(x)model = Model(input=[img_in], output=[angle_out])model. compile(optimizer=&#39;adam&#39;, loss=&#39;mean_squared_error&#39;)model. summary()  ____________________________________________________________________________________________________Layer (type)           Output Shape     Param #   Connected to           ====================================================================================================img_in (InputLayer)       (None, 120, 160, 3)  0                      ____________________________________________________________________________________________________convolution2d_1 (Convolution2D) (None, 118, 158, 8)  224     img_in[0][0]           ____________________________________________________________________________________________________activation_1 (Activation)    (None, 118, 158, 8)  0      convolution2d_1[0][0]      ____________________________________________________________________________________________________maxpooling2d_1 (MaxPooling2D)  (None, 59, 79, 8)   0      activation_1[0][0]        ____________________________________________________________________________________________________convolution2d_2 (Convolution2D) (None, 57, 77, 16)  1168    maxpooling2d_1[0][0]       ____________________________________________________________________________________________________activation_2 (Activation)    (None, 57, 77, 16)  0      convolution2d_2[0][0]      ____________________________________________________________________________________________________maxpooling2d_2 (MaxPooling2D)  (None, 28, 38, 16)  0      activation_2[0][0]        ____________________________________________________________________________________________________convolution2d_3 (Convolution2D) (None, 26, 36, 32)  4640    maxpooling2d_2[0][0]       ____________________________________________________________________________________________________activation_3 (Activation)    (None, 26, 36, 32)  0      convolution2d_3[0][0]      ____________________________________________________________________________________________________maxpooling2d_3 (MaxPooling2D)  (None, 13, 18, 32)  0      activation_3[0][0]        ____________________________________________________________________________________________________flatten_1 (Flatten)       (None, 7488)     0      maxpooling2d_3[0][0]       ____________________________________________________________________________________________________dense_1 (Dense)         (None, 256)      1917184   flatten_1[0][0]         ____________________________________________________________________________________________________activation_4 (Activation)    (None, 256)      0      dense_1[0][0]          ____________________________________________________________________________________________________dropout_1 (Dropout)       (None, 256)      0      activation_4[0][0]        ____________________________________________________________________________________________________angle_out (Dense)        (None, 1)       257     dropout_1[0][0]         ====================================================================================================Total params: 1,923,473Trainable params: 1,923,473Non-trainable params: 0____________________________________________________________________________________________________  Train the model. &#182;: I've learned the hard way that even if everything to this point is perfect, your autopilot won't work if you don't train it correctly. The biggest problem I ran into was over fitting the model so that it would not work in evenlly slightly different scenarios. Here are 2 Keras callbacks that will save you time. Warning - This will take a long time (3hrs) if only using a CPU I ran this notebook on my Dell XPS notebook that does not have a CUDA compatible GPU so it's very slow and freezes. To speed up training you can uses a EC2 instance with a GPU. Several instance images exist with Keras and Tensorflow already loaded.       import osfrom keras import callbacksmodel_path = os. path. expanduser(&#39;~/best_autopilot. hdf5&#39;)#Save the model after each epoch if the validation loss improved. save_best = callbacks. ModelCheckpoint(model_path, monitor=&#39;val_loss&#39;, verbose=1,                   save_best_only=True, mode=&#39;min&#39;)#stop training if the validation loss doesn&#39;t improve for 5 consecutive epochs. early_stop = callbacks. EarlyStopping(monitor=&#39;val_loss&#39;, min_delta=0, patience=5,                   verbose=0, mode=&#39;auto&#39;)callbacks_list = [save_best, early_stop]    For this notebook, I'll only train the model for 4 epochs.       model. fit(train_X, train_Y, batch_size=64, nb_epoch=4, validation_data=(val_X, val_Y), callbacks=callbacks_list)  Train on 12626 samples, validate on 789 samplesEpoch 1/412608/12626 [============================&gt;. ] - ETA: 0s - loss: 821. 4849  Epoch 00000: val_loss improved from inf to 516. 59291, saving model to /home/wroscoe/best_autopilot. hdf512626/12626 [==============================] - 384s - loss: 822. 5694 - val_loss: 516. 5929Epoch 2/412608/12626 [============================&gt;. ] - ETA: 0s - loss: 430. 3060 Epoch 00001: val_loss improved from 516. 59291 to 384. 87241, saving model to /home/wroscoe/best_autopilot. hdf512626/12626 [==============================] - 400s - loss: 430. 4499 - val_loss: 384. 8724Epoch 3/412608/12626 [============================&gt;. ] - ETA: 0s - loss: 348. 3565 Epoch 00002: val_loss improved from 384. 87241 to 321. 23424, saving model to /home/wroscoe/best_autopilot. hdf512626/12626 [==============================] - 328s - loss: 348. 1003 - val_loss: 321. 2342Epoch 4/412608/12626 [============================&gt;. ] - ETA: 0s - loss: 304. 5375 Epoch 00003: val_loss did not improve12626/12626 [==============================] - 327s - loss: 304. 4417 - val_loss: 326. 8560&lt;keras. callbacks. History at 0x7f3f686b78d0&gt;  Evaluate Performance&#182;: We can check if our models predictions are reasonable by plotting the predictions vs the actual values. The first graph shows that there is a learned relationship in our test data (not seen by model during training).       import pandas as pdmodel = load_model(model_path)test_P = model. predict(test_X)test_P = test_P. reshape((test_P. shape[0],))           df = pd. DataFrame({&#39;predicted&#39;:test_P, &#39;actual&#39;:test_Y})ax = df. plot. scatter(&#39;predicted&#39;, &#39;actual&#39;)#ax. set_ylabel(&quot;steering angle&quot;)    This second graph uses the unshuffled data that includes the training data to show the predicted angles closely follow the actual steering angles.       P = model. predict(X[:700])#predict outputs nested arrays so we need to reshape to plot. P = P. reshape((P. shape[0],)) ax = pd. DataFrame({&#39;predicted&#39;:P, &#39;actual&#39;:Y[:700]}). plot()ax. set_ylabel(&quot;steering angle&quot;)  &lt;matplotlib. text. Text at 0x7f3ebb13a7f0&gt;  Next steps&#182;: Improve Model This model is naive because it doesn't use past values to help predict the future. We could experiment with the model by feeding past steering angles as inputs to the model, add a recurrent layer, or just change the structure of the convolution layers. Add more data This model will improve as we add more driving data. Predict throttle outputs Currently the autopilot only steers and maintains a constant speed. A more sophisticated model would speed up on straightaways and slow down before curbs. "
    }, {
    "id": 9,
    "url": "https://www.wroscoe.com/donkeycar/tensorflow/deeplearing/2017/01/02/generate_movie_for_cnns.html",
    "title": "Generate a movie to test that your CNN is actually training.",
    "body": "2017/01/02 -           When training convolution neural networks (CNNs) doesn't work, it's difficult to know what went wrong. A starting point for debugging these networks is training them on clean data with clear patters. In this notebook I create a simple image sequence of a moving square and attempt to predict its x (horizontal) cordinate.       import numpy as npimport random from matplotlib. pyplot import imshowfrom matplotlib import pyplot as pltfrom matplotlib import cm%matplotlib inline     This function can return the x and y possition but for now we just want to predict the x possition of the square.       def moving_square(n_frames=100, return_x=True, return_y=True):    &#39;&#39;&#39;  Generate sequence of images of square bouncing around   the image and labels of its coordinates. Can be used as a   basic simple performance test of convolution networks.   &#39;&#39;&#39;    row = 120  col = 160  movie = np. zeros((n_frames, row, col, 3), dtype=np. float)  labels = np. zeros((n_frames, 2), dtype=np. float)  #initial possition  x = np. random. randint(20, col-20)  y = np. random. randint(20, row-20)    # Direction of motion  directionx = -1  directiony = 1    # Size of the square  w = 4    for t in range(n_frames):    #move    x += directionx    y += directiony        #make square bounce off walls    if y &lt; 5 or y &gt; row-5:       directiony *= -1    if x &lt; 5 or x &gt; col-5:       directionx *= -1          #draw square and record labels    movie[t, y - w: y + w, x - w: x + w, 1] += 1    labels[t] = np. array([x, y])      #only return requested labels  if return_x and return_y:    return movie, labels  elif return_x and not return_y:    return movie, labels[:,0]  else:    return movie, labels[:,1]    Here we create images and the labels of the x possition. Both are numpy arrays containing 2000 samples each.       movie, labels = moving_square(2000, return_y=False)    Here we can see how the square bounces around the image to give us a wide range of possitions.       fig, ax = plt. subplots(1, 10, figsize=(15, 6),             subplot_kw={&#39;adjustable&#39;: &#39;box-forced&#39;})axoff = np. vectorize(lambda ax:ax. axis(&#39;off&#39;))axoff(ax)for i in range(10):  frame = i*20  ax[i]. imshow(movie[frame])  ax[i]. set_title(labels[frame])          def split_data(X, Y, test_frac=. 8):  count = len(X)  assert len(X) == len(Y)    cutoff = int((count * test_frac) // 1)    X_train = X[:cutoff]  Y_train = Y[:cutoff]    X_test = X[cutoff:]  Y_test = Y[cutoff:]    return X_train, Y_train, X_test, Y_test  movie_train, labels_train, movie_test, labels_test = split_data(movie, labels)print(&#39;training samples: %s,  test samples: %s&#39; %(len(movie_train), len(movie_test)))  training samples: 1600,  test samples: 400  Now that we have split our data into our training and test sets, we can create our model to test. For this example, well use a 3 layer convolution network with a dense layer at the end.       from keras. layers import Input, Embedding, LSTM, Dense, mergefrom keras. models import Modelfrom keras. layers import Convolution2D, MaxPooling2D,from keras. layers import Activation, Dropout, Flatten, Dense          def cnn3_full1():  img_in = Input(shape=(120, 160, 3), name=&#39;img_in&#39;)  angle_in = Input(shape=(1,), name=&#39;angle_in&#39;)  x = Convolution2D(8, 3, 3)(img_in)  x = Activation(&#39;relu&#39;)(x)  x = MaxPooling2D(pool_size=(2, 2))(x)  x = Convolution2D(16, 3, 3)(x)  x = Activation(&#39;relu&#39;)(x)  x = MaxPooling2D(pool_size=(2, 2))(x)  x = Convolution2D(32, 3, 3)(x)  x = Activation(&#39;relu&#39;)(x)  x = MaxPooling2D(pool_size=(2, 2))(x)  merged = Flatten()(x)  #merged = merge([flat, angle_in], mode=&#39;concat&#39;, concat_axis=-1)  x = Dense(256)(merged)  x = Activation(&#39;linear&#39;)(x)  x = Dropout(. 2)(x)  angle_out = Dense(1, name=&#39;angle_out&#39;)(x)  model = Model(input=[img_in], output=[angle_out])  return model    Since we are estimating a floating point value between 1 and 120 we've set our activation function to be linear and we'll use a mean squared error(mse) loss function.       model = cnn3_full1()model. compile(loss=&#39;mse&#39;, optimizer=&#39;adam&#39;)          model. fit(movie_train, labels_train, batch_size=32, nb_epoch=10,     validation_data=(movie_test, labels_test))  Train on 1600 samples, validate on 400 samplesEpoch 1/101600/1600 [==============================] - 19s - loss: 3231. 6821 - val_loss: 1382. 9762Epoch 2/101600/1600 [==============================] - 25s - loss: 506. 8916 - val_loss: 185. 6907Epoch 3/101600/1600 [==============================] - 25s - loss: 141. 4330 - val_loss: 104. 8761Epoch 4/101600/1600 [==============================] - 25s - loss: 93. 5230 - val_loss: 73. 3963Epoch 5/101600/1600 [==============================] - 27s - loss: 64. 1208 - val_loss: 61. 7327Epoch 6/101600/1600 [==============================] - 26s - loss: 50. 9679 - val_loss: 70. 5726Epoch 7/101600/1600 [==============================] - 33s - loss: 44. 5662 - val_loss: 69. 3478Epoch 8/101600/1600 [==============================] - 26s - loss: 36. 7403 - val_loss: 62. 1258Epoch 9/101600/1600 [==============================] - 32s - loss: 32. 8558 - val_loss: 62. 8279Epoch 10/101600/1600 [==============================] - 33s - loss: 30. 0092 - val_loss: 56. 4622&lt;keras. callbacks. History at 0x7f8d8083cb38&gt;  Our model here shows addequate training after 10 epochs. By showing the actual vs predited values of the test data, we can see that most predictions are within 1 pixel of the actual value. Now that we're sure that our model can learn a simple environment, we can try it on more complicated ones.       import pandas as pdpredictions = model. predict(movie_test[:400])results = {&#39;angle_pred&#39;:predictions[:,0],      &#39;angle_actual&#39;: labels_test[:400]}df = pd. DataFrame(data=results,)df           angle_actual   angle_pred         0   56. 0   55. 233990       1   57. 0   56. 693146       2   58. 0   57. 861286       3   59. 0   58. 791832       4   60. 0   59. 036770       5   61. 0   60. 441486       6   62. 0   61. 689087       7   63. 0   63. 456985       8   64. 0   64. 348381       9   65. 0   66. 222473       10   66. 0   67. 130646       11   67. 0   67. 738564       12   68. 0   67. 963821       13   69. 0   68. 935982       14   70. 0   69. 549744       15   71. 0   71. 431396       16   72. 0   72. 390083       17   73. 0   74. 190582       18   74. 0   74. 819740       19   75. 0   75. 444885       20   76. 0   75. 461914       21   77. 0   76. 146454       22   78. 0   76. 133331       23   79. 0   77. 773743       24   80. 0   78. 428741       25   81. 0   79. 718063       26   82. 0   79. 724319       27   83. 0   80. 628311       28   84. 0   81. 303391       29   85. 0   82. 617683       . . .    . . .    . . .        370   122. 0   121. 601166       371   123. 0   126. 386185       372   124. 0   126. 329117       373   125. 0   124. 133636       374   126. 0   121. 341873       375   127. 0   122. 241898       376   128. 0   118. 468033       377   129. 0   116. 506271       378   130. 0   115. 494576       379   131. 0   114. 433235       380   132. 0   113. 245926       381   133. 0   109. 520828       382   134. 0   108. 485291       383   135. 0   111. 566132       384   136. 0   113. 819847       385   137. 0   117. 470505       386   138. 0   125. 346176       387   139. 0   137. 456451       388   140. 0   143. 929260       389   141. 0   148. 688904       390   142. 0   151. 356018       391   143. 0   160. 217545       392   144. 0   159. 777679       393   145. 0   159. 734161       394   146. 0   155. 533234       395   147. 0   153. 263718       396   148. 0   144. 463562       397   149. 0   127. 741280       398   150. 0   111. 309967       399   151. 0   119. 974045   400 rows × 2 columns         ax = df. plot()ax. set_xlabel(&quot;samples&quot;)ax. set_ylabel(&quot;x value&quot;)  &lt;matplotlib. text. Text at 0x7f8d805741d0&gt;  These results of the test data show the actual angle and the predicted angle. The prediction accuracy in the middle of the image (x value between 100 and 40) is more accurate than the x values less than 40 and greater than 100. This is likely due to the view samples that occurred in those ranges. "
    }];

var idx = lunr(function () {
    this.ref('id')
    this.field('title')
    this.field('body')
    this.metadataWhitelist = ['position']

    documents.forEach(function (doc) {
        this.add(doc)
    }, this)
});
function lunr_search(term) {
    document.getElementById('lunrsearchresults').innerHTML = '<ul></ul>';
    if(term) {
        document.getElementById('lunrsearchresults').innerHTML = "<p>Search results for '" + term + "'</p>" + document.getElementById('lunrsearchresults').innerHTML;
        //put results on the screen.
        var results = idx.search(term);
        if(results.length>0){
            //console.log(idx.search(term));
            //if results
            for (var i = 0; i < results.length; i++) {
                // more statements
                var ref = results[i]['ref'];
                var url = documents[ref]['url'];
                var title = documents[ref]['title'];
                var body = documents[ref]['body'].substring(0,160)+'...';
                document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML + "<li class='lunrsearchresult'><a href='" + url + "'><span class='title'>" + title + "</span><br /><span class='body'>"+ body +"</span><br /><span class='url'>"+ url +"</span></a></li>";
            }
        } else {
            document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = "<li class='lunrsearchresult'>No results found...</li>";
        }
    }
    return false;
}